<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Algeria - الدردشة باللهجة الجزائرية</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-color: #2c6bac;
            --secondary-color: #d4e6ff;
            --accent-color: #ff7e30;
            --text-color: #333;
            --light-text: #fff;
            --bg-color: #f8f9fa;
            --msg-ai-bg: #e9f5ff;
            --msg-user-bg: #d4e6ff;
            --border-radius: 20px;
            --online-color: #4caf50;
            --offline-color: #f44336;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9f5ff 100%);
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), #1a4d80);
            color: var(--light-text);
            padding: 12px;
            text-align: center;
            position: relative;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 1.3rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .header p {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .api-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-top: 6px;
            font-size: 0.7rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-online {
            background-color: var(--online-color);
            box-shadow: 0 0 6px var(--online-color);
        }
        
        .status-offline {
            background-color: var(--offline-color);
        }
        
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 100%;
        }
        
        .message {
            max-width: 90%;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            position: relative;
            line-height: 1.5;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transform-origin: center;
            animation: messageAppear 0.3s ease;
            font-size: 0.9rem;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        @keyframes messageAppear {
            0% { opacity: 0; transform: scale(0.95) translateY(5px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .ai-message {
            align-self: flex-start;
            background: linear-gradient(135deg, var(--msg-ai-bg), #e3efff);
            border-bottom-left-radius: 5px;
            border-left: 3px solid var(--primary-color);
        }
        
        .user-message {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--msg-user-bg), #c9dfff);
            border-bottom-right-radius: 5px;
            border-right: 3px solid var(--accent-color);
        }
        
        .message-actions {
            position: absolute;
            top: 6px;
            left: 6px;
            display: flex;
            gap: 6px;
            opacity: 0.6;
            transition: opacity 0.3s;
        }
        
        .message:hover .message-actions {
            opacity: 1;
        }
        
        .user-message .message-actions {
            left: auto;
            right: 6px;
        }
        
        .btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            color: #666;
            transition: all 0.2s;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.7);
        }
        
        .btn:hover {
            color: var(--primary-color);
            background-color: rgba(255, 255, 255, 0.9);
            transform: scale(1.1);
        }
        
        .input-area {
            padding: 12px;
            background-color: #fff;
            border-top: 1px solid #ddd;
            display: flex;
            gap: 10px;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.03);
        }
        
        .message-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            font-size: 0.9rem;
            transition: all 0.3s;
            background-color: #f8f9fa;
            font-family: 'Cairo', sans-serif;
        }
        
        .message-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(44, 107, 172, 0.2);
        }
        
        .send-btn {
            background: linear-gradient(135deg, var(--primary-color), #1a4d80);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);
            font-size: 1rem;
        }
        
        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        
        .send-btn:active {
            transform: translateY(0);
        }
        
        .footer {
            text-align: center;
            padding: 10px;
            background-color: #f1f1f1;
            font-size: 0.7rem;
            color: #666;
            border-top: 1px solid #ddd;
        }
        
        .footer a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .footer a:hover {
            text-decoration: underline;
            color: #1a4d80;
        }
        
        .code-block {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 10px;
            border-radius: 6px;
            margin: 8px 0;
            overflow-x: auto;
            position: relative;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            border-left: 3px solid var(--accent-color);
        }
        
        .copy-code {
            position: absolute;
            top: 6px;
            left: 6px;
            background-color: #555;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 3px 8px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .copy-code:hover {
            background-color: #666;
            transform: scale(1.05);
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            color: #666;
            font-style: italic;
            margin-top: 10px;
            padding: 8px 12px;
            background-color: var(--msg-ai-bg);
            border-radius: 15px;
            align-self: flex-start;
            animation: pulse 1.5s infinite;
            font-size: 0.85rem;
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
             100% { opacity: 0.6; }
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background-color: #666;
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-4px); }
        }
        
        @media (max-width: 768px) {
            .message {
                max-width: 92%;
                padding: 10px 12px;
                font-size: 0.85rem;
            }
            
            .header h1 {
                font-size: 1.1rem;
            }
            
            .btn {
                width: 22px;
                height: 22px;
                font-size: 0.7rem;
            }
            
            .chat-container {
                padding: 10px;
                gap: 12px;
            }
            
            .input-area {
                padding: 10px;
            }
            
            .message-input {
                padding: 8px 12px;
                font-size: 0.85rem;
            }
            
            .send-btn {
                width: 40px;
                height: 40px;
                font-size: 0.9rem;
            }
        }
        
        .emoji {
            font-size: 1.1rem;
            vertical-align: middle;
            margin: 0 2px;
        }
        
        .developer-info {
            background: linear-gradient(135deg, #e9f5ff, #d4e6ff);
            border-radius: 10px;
            padding: 10px;
            margin: 8px 0;
            border-right: 3px solid var(--primary-color);
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
        }
        
        .social-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--primary-color);
            text-decoration: none;
            margin-top: 5px;
            padding: 4px 8px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 4px;
            transition: all 0.2s;
            font-weight: 500;
            font-size: 0.8rem;
        }
        
        .social-link:hover {
            background-color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }
        
        .message.highlight {
            animation: highlight 1s ease;
        }
        
        @keyframes highlight {
            0% { background: linear-gradient(135deg, var(--msg-ai-bg), #e3efff); }
            50% { background: linear-gradient(135deg, #ffeac5, #ffdfaa); }
            100% { background: linear-gradient(135deg, var(--msg-ai-bg), #e3efff); }
        }
        
        .notification {
            position: fixed;
            top: 15px;
            right: 15px;
            padding: 10px 15px;
            border-radius: 6px;
            background-color: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            max-width: 280px;
            font-size: 0.8rem;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            border-left: 3px solid var(--online-color);
        }
        
        .notification.error {
            border-left: 3px solid var(--offline-color);
        }
        
        .message-content {
            line-height: 1.5;
        }
        
        .message-content p {
            margin-bottom: 8px;
        }
        
        .message-content :last-child {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-robot"></i> AI Algerian - الدردشة باللهجة الجزائرية</h1>
        <p>تحدث مع الذكاء الاصطناعي باللهجة الجزائرية <span class="emoji">🇩🇿</span></p>
        <div class="api-status">
            <span class="status-dot status-online" id="statusDot"></span>
            <span id="statusText">متصل بالخادم</span>
        </div>
    </div>
    
    <div class="chat-container" id="chatContainer">
        <div class="message ai-message">
            <div class="message-actions">
                <button class="btn copy-btn"><i class="fas fa-copy"></i></button>
                <button class="btn tts-btn"><i class="fas fa-volume-up"></i></button>
            </div>
            <div class="message-content">
                <p>آهلاً بيك يا صديقي! <span class="emoji">👋</span></p>
                <p>أنا <strong>AI Algerian</strong>، الذكاء الاصطناعي اللي يتكلم باللهجة الجزائرية ويحب يضحك ويساعد! <span class="emoji">😄</span></p>
                <p>شنواش تحب تحكي معايا اليوم؟ عندي stories ونكاش ونصائح... وخبارك؟ <span class="emoji">💬</span></p>
            </div>
        </div>
    </div>
    
    <div class="input-area">
        <input type="text" class="message-input" id="messageInput" placeholder="اكتب رسالتك هنا...">
        <button class="send-btn" id="sendBtn">
            <i class="fas fa-paper-plane"></i>
        </button>
    </div>
    
    <div class="footer">
        تم التطوير بواسطة <a href="https://www.facebook.com/Medani.abdelaziz" target="_blank">عبد العزيز مداني</a> | 
        جميع الحقوق محفوظة &copy; 2025
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatContainer = document.getElementById('chatContainer');
            const messageInput = document.getElementById('messageInput');
            const sendBtn = document.getElementById('sendBtn');
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            
            const API_KEY = 'AIzaSyBL5vvrHdXpKcOFE5sCrMO5RNxcz9cJM3Q';
            const API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';
            
            // إضافة رسالة إلى الدردشة
            function addMessage(text, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
                
                // إضافة أزرار النسخ وقراءة النص للرسائل الآتية من الذكاء الاصطناعي
                if (!isUser) {
                    const actionsDiv = document.createElement('div');
                    actionsDiv.className = 'message-actions';
                    actionsDiv.innerHTML = `
                        <button class="btn copy-btn"><i class="fas fa-copy"></i></button>
                        <button class="btn tts-btn"><i class="fas fa-volume-up"></i></button>
                    `;
                    messageDiv.appendChild(actionsDiv);
                }
                
                const messageContent = document.createElement('div');
                messageContent.className = 'message-content';
                
                // معالجة النص لعرض الأكواد بشكل صحيح
                const processedText = processTextForDisplay(text);
                messageContent.innerHTML = processedText;
                
                messageDiv.appendChild(messageContent);
                
                chatContainer.appendChild(messageDiv);
                
                // التمرير إلى الأسفل
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                // إضافة مستمعين للأزرار إذا كانت الرسالة من الذكاء الاصطناعي
                if (!isUser) {
                    const copyBtn = messageDiv.querySelector('.copy-btn');
                    const ttsBtn = messageDiv.querySelector('.tts-btn');
                    
                    copyBtn.addEventListener('click', () => {
                        navigator.clipboard.writeText(messageContent.textContent)
                            .then(() => {
                                copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                                setTimeout(() => {
                                    copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
                                }, 2000);
                            });
                    });
                    
                    ttsBtn.addEventListener('click', () => {
                        // إيقاف أي كلام سابق
                        window.speechSynthesis.cancel();
                        
                        const speech = new SpeechSynthesisUtterance(messageContent.textContent);
                        speech.lang = 'ar-SA';
                        speech.rate = 0.9;
                        speech.pitch = 1;
                        
                        // البحث عن صوت عربي
                        const voices = window.speechSynthesis.getVoices();
                        let arabicVoice = voices.find(voice => voice.lang.includes('ar'));
                        
                        if (arabicVoice) {
                            speech.voice = arabicVoice;
                        }
                        
                        window.speechSynthesis.speak(speech);
                    });
                }
                
                // تأثير ظهور الرسائل
                setTimeout(() => {
                    messageDiv.classList.add('highlight');
                    setTimeout(() => {
                        messageDiv.classList.remove('highlight');
                    }, 1000);
                }, 100);
            }
            
            // معالجة النص لعرض الأكواد بشكل صحيح
            function processTextForDisplay(text) {
                // تقسيم النص إلى أسطر
                const lines = text.split('\n');
                let result = '';
                let inCodeBlock = false;
                
                for (let line of lines) {
                    // اكتشاف بداية كود بلوك
                    if (line.trim().startsWith('```')) {
                        if (!inCodeBlock) {
                            result += '<div class="code-block"><button class="copy-code">نسخ</button><code>';
                            inCodeBlock = true;
                        } else {
                            result += '</code></div>';
                            inCodeBlock = false;
                        }
                        continue;
                    }
                    
                    if (inCodeBlock) {
                        // داخل كود بلوك - إظهار النص كما هو
                        result += line + '\n';
                    } else {
                        // خارج كود بلوك - معالجة النص العادي
                        if (line.trim() !== '') {
                            result += '<p>' + line + '</p>';
                        }
                    }
                }
                
                // إذا انتهى النص ونحن داخل كود بلوك، نغلقه
                if (inCodeBlock) {
                    result += '</code></div>';
                }
                
                return result;
            }
            
            // الحصول على رد من الذكاء الاصطناعي
            async function getAIResponse(userMessage) {
                // إذا سأل المستخدم عن المطور
                if (userMessage.includes('مطور') || userMessage.includes('طورك') || userMessage.includes('دربك') || userMessage.includes('صاحبك') || userMessage.includes('مين صنعك')) {
                    return `
مداني عبد العزيز هو اللي درّبني وعلّمني كل حاجة! الراجل ما يستهانش بيه والله! 🚀

تقدر تتواصل معاه على الفيسبوك:
https://www.facebook.com/Medani.abdelaziz
                    `;
                }
                
                try {
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-goog-api-key': API_KEY
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: `أنت AI Algerian، ذكاء اصطناعي يتحدث باللهجة الجزائرية باسلوب مضحك، مهذب وذي كاريزما. 
                                    يجب أن تكون ردودك باللهجة الجزائرية الصحيحة، واستخدم الايموجيز المناسبة.
                                    كن مرحاً وودوداً في ردودك.
                                    الردود يجب أن تكون مختصرة (لا تزيد عن 200 حرف) إلا إذا طلب منك المستخدم شرحاً مفصلاً.
                                    الرد على هذا السؤال: ${userMessage}`
                                }]
                            }],
                            generationConfig: {
                                temperature: 0.8,
                                topK: 40,
                                topP: 0.95,
                                maxOutputTokens: 250,
                            }
                        })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || 'خطأ في الاتصال بالخادم');
                    }
                    
                    const data = await response.json();
                    
                    if (data && data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0]) {
                        let responseText = data.candidates[0].content.parts[0].text;
                        
                        // تقصير الرد إذا كان طويلاً جداً
                        if (responseText.length > 200 && !userMessage.includes('اشرح') && !userMessage.includes('تفصيل')) {
                            responseText = responseText.substring(0, 197) + '...';
                        }
                        
                        return responseText;
                    } else {
                        throw new Error('رد غير متوقع من الخادم');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    return `يا هاني! واللهى عندي مشكلة تقنية بسيطة... 😅
ما تقلقش، جرب تاني بعد شوية وكل حاجة تماها!`;
                }
            }
            
            // إظهار مؤشر الكتابة
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typingIndicator';
                typingDiv.innerHTML = `
                    AI Algerian يكتب <span class="emoji">✍️</span>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                chatContainer.appendChild(typingDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
            
            // إخفاء مؤشر الكتابة
            function hideTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }
            
            // معالجة إرسال الرسالة
            async function handleSendMessage() {
                const message = messageInput.value.trim();
                if (message) {
                    addMessage(`<p>${message}</p>`, true);
                    messageInput.value = '';
                    
                    // محاكاة وقت انتظار للرد
                    showTypingIndicator();
                    
                    try {
                        const response = await getAIResponse(message);
                        hideTypingIndicator();
                        addMessage(response);
                    } catch (error) {
                        hideTypingIndicator();
                        addMessage(`<p>عذرًا، حدث خطأ في الاتصال. <span class="emoji">😞</span></p>`);
                    }
                    
                    // إضافة مستمعين لأزرار النسخ في الأكواد
                    setTimeout(() => {
                        const codeBlocks = document.querySelectorAll('.code-block');
                        codeBlocks.forEach(block => {
                            const copyButton = block.querySelector('.copy-code');
                            if (copyButton) {
                                copyButton.addEventListener('click', () => {
                                    const code = block.querySelector('code').textContent;
                                    navigator.clipboard.writeText(code)
                                        .then(() => {
                                            copyButton.textContent = 'تم النسخ!';
                                            setTimeout(() => {
                                                copyButton.textContent = 'نسخ';
                                            }, 2000);
                                        });
                                });
                            }
                        });
                    }, 100);
                }
            }
            
            // إرسال بالضغط على الزر
            sendBtn.addEventListener('click', handleSendMessage);
            
            // إرسال بالضغط على Enter
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleSendMessage();
                }
            });
            
            // إضافة مستمعين لأزرار النسخ وقراءة النص في الرسالة الأولى
            const initialMessage = document.querySelector('.ai-message');
            if (initialMessage) {
                const copyBtn = initialMessage.querySelector('.copy-btn');
                const ttsBtn = initialMessage.querySelector('.tts-btn');
                
                if (copyBtn) {
                    copyBtn.addEventListener('click', function() {
                        const message = this.closest('.message').querySelector('.message-content').textContent;
                        navigator.clipboard.writeText(message)
                            .then(() => {
                                this.innerHTML = '<i class="fas fa-check"></i>';
                                setTimeout(() => {
                                    this.innerHTML = '<i class="fas fa-copy"></i>';
                                }, 2000);
                            });
                    });
                }
                
                if (ttsBtn) {
                    ttsBtn.addEventListener('click', function() {
                        window.speechSynthesis.cancel();
                        
                        const message = this.closest('.message').querySelector('.message-content').textContent;
                        const speech = new SpeechSynthesisUtterance(message);
                        speech.lang = 'ar-SA';
                        speech.rate = 0.9;
                        
                        const voices = window.speechSynthesis.getVoices();
                        let arabicVoice = voices.find(voice => voice.lang.includes('ar'));
                        
                        if (arabicVoice) {
                            speech.voice = arabicVoice;
                        }
                        
                        window.speechSynthesis.speak(speech);
                    });
                }
            }
            
            // التركيز على حقل الإدخال عند التحميل
            messageInput.focus();
            
            // تهيئة أصوات Text-to-Speech
            if (window.speechSynthesis) {
                window.speechSynthesis.onvoiceschanged = function() {
                    // الأصوات متاحة الآن
                };
            }
        });
    </script>
</body>
</html>